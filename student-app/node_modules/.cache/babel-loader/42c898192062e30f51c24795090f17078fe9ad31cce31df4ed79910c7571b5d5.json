{"ast":null,"code":"import axios from 'axios';\nexport default {\n  name: \"Profile\",\n  data() {\n    return {\n      profile: null,\n      form: {\n        nickname: '',\n        avatar: ''\n      }\n    };\n  },\n  mounted() {\n    const token = localStorage.getItem('token');\n    axios.get('http://localhost:5000/api/student/profile', {\n      headers: {\n        'x-auth-token': token\n      }\n    }).then(res => {\n      this.profile = res.data;\n      this.form.nickname = res.data.nickname || res.data.name;\n      this.form.avatar = res.data.avatar || '';\n    }).catch(err => {\n      console.error(err);\n    });\n  },\n  methods: {\n    handleAvatarSuccess(response, file) {\n      this.form.avatar = response.url || URL.createObjectURL(file.raw);\n    },\n    beforeAvatarUpload(file) {\n      const isImage = file.type.startsWith('image/');\n      const isLt2M = file.size / 1024 / 1024 < 2;\n      if (!isImage) {\n        this.$message.error('上传头像图片只能是图片格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isImage && isLt2M;\n    },\n    saveProfile() {\n      const token = localStorage.getItem('token');\n      axios.put('http://localhost:5000/api/student/profile', {\n        nickname: this.form.nickname,\n        avatar: this.form.avatar\n      }, {\n        headers: {\n          'x-auth-token': token\n        }\n      }).then(res => {\n        this.$message.success('资料更新成功');\n        this.profile = res.data;\n        localStorage.setItem('user', JSON.stringify(res.data));\n        this.$router.push('/');\n      }).catch(err => {\n        this.$message.error('更新失败');\n      });\n    },\n    cancelEdit() {\n      this.form.nickname = this.profile.nickname || this.profile.name;\n      this.form.avatar = this.profile.avatar || '';\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","profile","form","nickname","avatar","mounted","token","localStorage","getItem","get","headers","then","res","catch","err","console","error","methods","handleAvatarSuccess","response","file","url","URL","createObjectURL","raw","beforeAvatarUpload","isImage","type","startsWith","isLt2M","size","$message","saveProfile","put","success","setItem","JSON","stringify","$router","push","cancelEdit"],"sources":["D:\\Code\\coding\\edu-platform\\student-app\\src\\components\\Profile.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-container\" v-if=\"profile\">\r\n    <el-card class=\"profile-card\">\r\n      <h2 style=\"text-align:center;\">个人资料</h2>\r\n      <el-form :model=\"form\" label-width=\"100px\">\r\n        <el-form-item label=\"昵称\">\r\n          <el-input v-model=\"form.nickname\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"头像\">\r\n          <el-upload\r\n              class=\"avatar-uploader\"\r\n              action=\"https://jsonplaceholder.typicode.com/posts/\"  <!-- 请替换为实际上传接口 -->\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\">\r\n          <img v-if=\"form.avatar\" :src=\"form.avatar\" class=\"avatar\" alt=\"avatar\">\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div style=\"text-align:center; margin-top: 20px;\">\r\n        <el-button type=\"primary\" @click=\"saveProfile\">保存</el-button>\r\n        <el-button @click=\"cancelEdit\">取消</el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n  <div v-else class=\"loading-container\">\r\n    <el-skeleton animated />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nexport default {\r\n  name: \"Profile\",\r\n  data() {\r\n    return {\r\n      profile: null,\r\n      form: {\r\n        nickname: '',\r\n        avatar: ''\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    const token = localStorage.getItem('token')\r\n    axios.get('http://localhost:5000/api/student/profile', {\r\n      headers: { 'x-auth-token': token }\r\n    }).then(res => {\r\n      this.profile = res.data\r\n      this.form.nickname = res.data.nickname || res.data.name\r\n      this.form.avatar = res.data.avatar || ''\r\n    }).catch(err => {\r\n      console.error(err)\r\n    })\r\n  },\r\n  methods: {\r\n    handleAvatarSuccess(response, file) {\r\n      this.form.avatar = response.url || URL.createObjectURL(file.raw)\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isImage = file.type.startsWith('image/')\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isImage) {\r\n        this.$message.error('上传头像图片只能是图片格式!')\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!')\r\n      }\r\n      return isImage && isLt2M\r\n    },\r\n    saveProfile() {\r\n      const token = localStorage.getItem('token')\r\n      axios.put('http://localhost:5000/api/student/profile', {\r\n        nickname: this.form.nickname,\r\n        avatar: this.form.avatar\r\n      }, {\r\n        headers: { 'x-auth-token': token }\r\n      }).then(res => {\r\n        this.$message.success('资料更新成功')\r\n        this.profile = res.data\r\n        localStorage.setItem('user', JSON.stringify(res.data))\r\n        this.$router.push('/');\r\n      }).catch(err => {\r\n        this.$message.error('更新失败')\r\n      })\r\n    },\r\n    cancelEdit() {\r\n      this.form.nickname = this.profile.nickname || this.profile.name\r\n      this.form.avatar = this.profile.avatar || ''\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  padding: 40px 20px;\r\n}\r\n.profile-card {\r\n  width: 100%;\r\n  max-width: 500px;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n}\r\n.avatar-uploader {\r\n  display: block;\r\n  width: 100px;\r\n  height: 100px;\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 100%;\r\n  height: 100%;\r\n  line-height: 100px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: block;\r\n  border-radius: 50%;\r\n}\r\n.loading-container {\r\n  text-align: center;\r\n  padding: 40px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}