{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"profile-container\"\n};\nconst _hoisted_2 = [\"src\"];\nconst _hoisted_3 = {\n  key: 1,\n  class: \"el-icon-plus avatar-uploader-icon\"\n};\nconst _hoisted_4 = {\n  style: {\n    \"text-align\": \"center\",\n    \"margin-top\": \"20px\"\n  }\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"loading-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_upload = _resolveComponent(\"el-upload\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  const _component_el_skeleton = _resolveComponent(\"el-skeleton\");\n  return $data.profile ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    class: \"profile-card\"\n  }, {\n    default: _withCtx(() => [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", {\n      style: {\n        \"text-align\": \"center\"\n      }\n    }, \"个人资料\", -1 /* HOISTED */)), _createVNode(_component_el_form, {\n      model: $data.form,\n      \"label-width\": \"100px\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"昵称\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.form.nickname,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.form.nickname = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"头像\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_upload, {\n          class: \"avatar-uploader\",\n          action: \"https://jsonplaceholder.typicode.com/posts/\",\n          \"<!--\": \"\",\n          请替换为实际上传接口: \"\",\n          \"--\": \"\"\n        }, {\n          default: _withCtx(() => [_cache[1] || (_cache[1] = _createTextVNode(\" :show-file-list=\\\"false\\\" :on-success=\\\"handleAvatarSuccess\\\" :before-upload=\\\"beforeAvatarUpload\\\"> \")), $data.form.avatar ? (_openBlock(), _createElementBlock(\"img\", {\n            key: 0,\n            src: $data.form.avatar,\n            class: \"avatar\",\n            alt: \"avatar\"\n          }, null, 8 /* PROPS */, _hoisted_2)) : (_openBlock(), _createElementBlock(\"i\", _hoisted_3))]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"]), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $options.saveProfile\n    }, {\n      default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\"保存\")])),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n      onClick: $options.cancelEdit\n    }, {\n      default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\"取消\")])),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\"])])]),\n    _: 1 /* STABLE */\n  })])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createVNode(_component_el_skeleton, {\n    animated: \"\"\n  })]));\n}","map":{"version":3,"names":["key","class","style","$data","profile","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","default","_withCtx","_createElementVNode","_component_el_form","model","form","_component_el_form_item","label","_component_el_input","modelValue","nickname","_cache","$event","_","_component_el_upload","action","请替换为实际上传接口","_createTextVNode","avatar","src","alt","_hoisted_2","_hoisted_3","_hoisted_4","_component_el_button","type","onClick","$options","saveProfile","cancelEdit","_hoisted_5","_component_el_skeleton","animated"],"sources":["D:\\Code\\coding\\edu-platform\\student-app\\src\\components\\Profile.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-container\" v-if=\"profile\">\r\n    <el-card class=\"profile-card\">\r\n      <h2 style=\"text-align:center;\">个人资料</h2>\r\n      <el-form :model=\"form\" label-width=\"100px\">\r\n        <el-form-item label=\"昵称\">\r\n          <el-input v-model=\"form.nickname\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"头像\">\r\n          <el-upload\r\n              class=\"avatar-uploader\"\r\n              action=\"https://jsonplaceholder.typicode.com/posts/\"  <!-- 请替换为实际上传接口 -->\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\">\r\n          <img v-if=\"form.avatar\" :src=\"form.avatar\" class=\"avatar\" alt=\"avatar\">\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div style=\"text-align:center; margin-top: 20px;\">\r\n        <el-button type=\"primary\" @click=\"saveProfile\">保存</el-button>\r\n        <el-button @click=\"cancelEdit\">取消</el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n  <div v-else class=\"loading-container\">\r\n    <el-skeleton animated />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nexport default {\r\n  name: \"Profile\",\r\n  data() {\r\n    return {\r\n      profile: null,\r\n      form: {\r\n        nickname: '',\r\n        avatar: ''\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    const token = localStorage.getItem('token')\r\n    axios.get('http://localhost:5000/api/student/profile', {\r\n      headers: { 'x-auth-token': token }\r\n    }).then(res => {\r\n      this.profile = res.data\r\n      this.form.nickname = res.data.nickname || res.data.name\r\n      this.form.avatar = res.data.avatar || ''\r\n    }).catch(err => {\r\n      console.error(err)\r\n    })\r\n  },\r\n  methods: {\r\n    handleAvatarSuccess(response, file) {\r\n      this.form.avatar = response.url || URL.createObjectURL(file.raw)\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isImage = file.type.startsWith('image/')\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isImage) {\r\n        this.$message.error('上传头像图片只能是图片格式!')\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!')\r\n      }\r\n      return isImage && isLt2M\r\n    },\r\n    saveProfile() {\r\n      const token = localStorage.getItem('token')\r\n      axios.put('http://localhost:5000/api/student/profile', {\r\n        nickname: this.form.nickname,\r\n        avatar: this.form.avatar\r\n      }, {\r\n        headers: { 'x-auth-token': token }\r\n      }).then(res => {\r\n        this.$message.success('资料更新成功')\r\n        this.profile = res.data\r\n        localStorage.setItem('user', JSON.stringify(res.data))\r\n        this.$router.push('/');\r\n      }).catch(err => {\r\n        this.$message.error('更新失败')\r\n      })\r\n    },\r\n    cancelEdit() {\r\n      this.form.nickname = this.profile.nickname || this.profile.name\r\n      this.form.avatar = this.profile.avatar || ''\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  padding: 40px 20px;\r\n}\r\n.profile-card {\r\n  width: 100%;\r\n  max-width: 500px;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n}\r\n.avatar-uploader {\r\n  display: block;\r\n  width: 100px;\r\n  height: 100px;\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 50%;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 100%;\r\n  height: 100%;\r\n  line-height: 100px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: block;\r\n  border-radius: 50%;\r\n}\r\n.loading-container {\r\n  text-align: center;\r\n  padding: 40px;\r\n}\r\n</style>\r\n"],"mappings":";;EAAAA,GAAA;EACOC,KAAK,EAAC;;mBADb;;EAAAD,GAAA;EAgBoBC,KAAK,EAAC;;;EAIfC,KAA4C,EAA5C;IAAA;IAAA;EAAA;AAA4C;;EApBvDF,GAAA;EA0BcC,KAAK,EAAC;;;;;;;;;;SAzBmBE,KAAA,CAAAC,OAAO,I,cAA5CC,mBAAA,CAwBM,OAxBNC,UAwBM,GAvBJC,YAAA,CAsBUC,kBAAA;IAtBDP,KAAK,EAAC;EAAc;IAFjCQ,OAAA,EAAAC,QAAA,CAGM,MAAwC,C,0BAAxCC,mBAAA,CAAwC;MAApCT,KAA0B,EAA1B;QAAA;MAAA;IAA0B,GAAC,MAAI,sBACnCK,YAAA,CAeUK,kBAAA;MAfAC,KAAK,EAAEV,KAAA,CAAAW,IAAI;MAAE,aAAW,EAAC;;MAJzCL,OAAA,EAAAC,QAAA,CAKQ,MAEe,CAFfH,YAAA,CAEeQ,uBAAA;QAFDC,KAAK,EAAC;MAAI;QALhCP,OAAA,EAAAC,QAAA,CAMU,MAA6C,CAA7CH,YAAA,CAA6CU,mBAAA;UANvDC,UAAA,EAM6Bf,KAAA,CAAAW,IAAI,CAACK,QAAQ;UAN1C,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAM6BlB,KAAA,CAAAW,IAAI,CAACK,QAAQ,GAAAE,MAAA;;QAN1CC,CAAA;UAQQf,YAAA,CAUeQ,uBAAA;QAVDC,KAAK,EAAC;MAAI;QARhCP,OAAA,EAAAC,QAAA,CASU,MAQY,CARZH,YAAA,CAQYgB,oBAAA;UAPRtB,KAAK,EAAC,iBAAiB;UACvBuB,MAAM,EAAC,6CAA6C;UAAE,MAAI,EAAJ,EAAI;UAACC,UAAU,EAAV,EAAU;UAAC,IAAE,EAAF;;UAXpFhB,OAAA,EAAAC,QAAA,CAWuF,MAI7E,C,0BAfVgB,gBAAA,CAWuF,wGAI7E,IAAWvB,KAAA,CAAAW,IAAI,CAACa,MAAM,I,cAAtBtB,mBAAA,CAAuE;YAfjFL,GAAA;YAemC4B,GAAG,EAAEzB,KAAA,CAAAW,IAAI,CAACa,MAAM;YAAE1B,KAAK,EAAC,QAAQ;YAAC4B,GAAG,EAAC;kCAfxEC,UAAA,M,cAgBUzB,mBAAA,CAAwD,KAAxD0B,UAAwD,G;UAhBlET,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;kCAoBMX,mBAAA,CAGM,OAHNqB,UAGM,GAFJzB,YAAA,CAA6D0B,oBAAA;MAAlDC,IAAI,EAAC,SAAS;MAAEC,OAAK,EAAEC,QAAA,CAAAC;;MArB1C5B,OAAA,EAAAC,QAAA,CAqBuD,MAAEU,MAAA,QAAAA,MAAA,OArBzDM,gBAAA,CAqBuD,IAAE,E;MArBzDJ,CAAA;oCAsBQf,YAAA,CAA6C0B,oBAAA;MAAjCE,OAAK,EAAEC,QAAA,CAAAE;IAAU;MAtBrC7B,OAAA,EAAAC,QAAA,CAsBuC,MAAEU,MAAA,QAAAA,MAAA,OAtBzCM,gBAAA,CAsBuC,IAAE,E;MAtBzCJ,CAAA;;IAAAA,CAAA;yBA0BEjB,mBAAA,CAEM,OAFNkC,UAEM,GADJhC,YAAA,CAAwBiC,sBAAA;IAAXC,QAAQ,EAAR;EAAQ,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}