{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"consultation-feedback-page\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading-state\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"feedback-error\"\n};\nconst _hoisted_4 = {\n  key: 2,\n  class: \"feedback-content\"\n};\nconst _hoisted_5 = {\n  class: \"consultant-info\"\n};\nconst _hoisted_6 = [\"src\", \"alt\"];\nconst _hoisted_7 = {\n  class: \"teacher-details\"\n};\nconst _hoisted_8 = {\n  class: \"feedback-form-container\"\n};\nconst _hoisted_9 = {\n  class: \"feedback-form-header\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_11 = {\n  class: \"rating-section\"\n};\nconst _hoisted_12 = {\n  class: \"star-rating\"\n};\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = {\n  class: \"form-group\"\n};\nconst _hoisted_15 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[14] || (_cache[14] = _createElementVNode(\"div\", {\n    class: \"feedback-header\"\n  }, [_createElementVNode(\"h1\", null, \"启明隅在线咨询 - 评价反馈\"), _createElementVNode(\"p\", null, \"您的反馈将帮助我们提供更好的服务\")], -1 /* HOISTED */)), $setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _cache[2] || (_cache[2] = [_createElementVNode(\"i\", {\n    class: \"fas fa-spinner fa-spin\"\n  }, null, -1 /* HOISTED */), _createElementVNode(\"p\", null, \"加载中...\", -1 /* HOISTED */)]))) : $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_cache[4] || (_cache[4] = _createElementVNode(\"i\", {\n    class: \"fas fa-exclamation-circle\"\n  }, null, -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($setup.error), 1 /* TEXT */), _createVNode(_component_router_link, {\n    to: \"/student/consultations\",\n    class: \"back-button\"\n  }, {\n    default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\" 返回咨询列表 \")])),\n    _: 1 /* STABLE */\n  })])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"img\", {\n    src: $setup.consultation.teacher.avatar || '/images/default-avatar.jpg',\n    alt: $setup.consultation.teacher.name,\n    class: \"teacher-avatar\"\n  }, null, 8 /* PROPS */, _hoisted_6), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"h3\", null, _toDisplayString($setup.consultation.teacher.name), 1 /* TEXT */), _createElementVNode(\"p\", null, _toDisplayString($setup.consultation.subject) + \" 教师\", 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"h2\", null, \"为\" + _toDisplayString($setup.consultation.teacher.name) + \"老师的咨询服务评分\", 1 /* TEXT */), _cache[5] || (_cache[5] = _createElementVNode(\"p\", null, \"请根据此次咨询体验进行评价\", -1 /* HOISTED */))]), $setup.submitError ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_cache[6] || (_cache[6] = _createElementVNode(\"i\", {\n    class: \"fas fa-exclamation-circle\"\n  }, null, -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($setup.submitError), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"form\", {\n    onSubmit: _cache[1] || (_cache[1] = _withModifiers((...args) => $setup.handleSubmit && $setup.handleSubmit(...args), [\"prevent\"])),\n    class: \"feedback-form\"\n  }, [_createElementVNode(\"div\", _hoisted_11, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", null, \"服务满意度\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_12, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList(5, n => {\n    return _createElementVNode(\"button\", {\n      key: n,\n      type: \"button\",\n      class: _normalizeClass(['star-btn', n <= $setup.feedback.rating ? 'active' : '']),\n      onClick: $event => $setup.feedback.rating = n\n    }, [...(_cache[7] || (_cache[7] = [_createElementVNode(\"i\", {\n      class: \"fas fa-star\"\n    }, null, -1 /* HOISTED */)]))], 10 /* CLASS, PROPS */, _hoisted_13);\n  }), 64 /* STABLE_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_14, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    for: \"comment\"\n  }, \"评价内容\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"textarea\", {\n    id: \"comment\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.feedback.comment = $event),\n    rows: \"5\",\n    placeholder: \"请分享您对此次咨询的评价和建议...\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.feedback.comment]])]), _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"submit-btn\",\n    disabled: $setup.submitting || !$setup.feedback.rating\n  }, [$setup.submitting ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 0\n  }, [_cache[10] || (_cache[10] = _createElementVNode(\"i\", {\n    class: \"fas fa-spinner fa-spin\"\n  }, null, -1 /* HOISTED */)), _cache[11] || (_cache[11] = _createTextVNode(\" 提交中... \"))], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_cache[12] || (_cache[12] = _createElementVNode(\"i\", {\n    class: \"fas fa-paper-plane\"\n  }, null, -1 /* HOISTED */)), _cache[13] || (_cache[13] = _createTextVNode(\" 提交评价 \"))], 64 /* STABLE_FRAGMENT */))], 8 /* PROPS */, _hoisted_15)], 32 /* NEED_HYDRATION */)])]))]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","$setup","loading","_hoisted_2","_cache","error","_hoisted_3","_toDisplayString","_createVNode","_component_router_link","to","default","_withCtx","_createTextVNode","_","_hoisted_4","_hoisted_5","src","consultation","teacher","avatar","alt","name","_hoisted_6","_hoisted_7","subject","_hoisted_8","_hoisted_9","submitError","_hoisted_10","_createCommentVNode","onSubmit","_withModifiers","args","handleSubmit","_hoisted_11","_hoisted_12","_Fragment","_renderList","n","type","_normalizeClass","feedback","rating","onClick","$event","_hoisted_13","_hoisted_14","for","id","comment","rows","placeholder","disabled","submitting","_hoisted_15"],"sources":["D:\\Code\\coding\\edu-platform\\client\\src\\views\\student\\ConsultationFeedback.vue"],"sourcesContent":["<template>\r\n    <div class=\"consultation-feedback-page\">\r\n        <div class=\"feedback-header\">\r\n            <h1>启明隅在线咨询 - 评价反馈</h1>\r\n            <p>您的反馈将帮助我们提供更好的服务</p>\r\n        </div>\r\n\r\n        <div v-if=\"loading\" class=\"loading-state\">\r\n            <i class=\"fas fa-spinner fa-spin\"></i>\r\n            <p>加载中...</p>\r\n        </div>\r\n\r\n        <div v-else-if=\"error\" class=\"feedback-error\">\r\n            <i class=\"fas fa-exclamation-circle\"></i>\r\n            <span>{{ error }}</span>\r\n            <router-link to=\"/student/consultations\" class=\"back-button\">\r\n                返回咨询列表\r\n            </router-link>\r\n        </div>\r\n\r\n        <div v-else class=\"feedback-content\">\r\n            <div class=\"consultant-info\">\r\n                <img :src=\"consultation.teacher.avatar || '/images/default-avatar.jpg'\" :alt=\"consultation.teacher.name\"\r\n                    class=\"teacher-avatar\" />\r\n                <div class=\"teacher-details\">\r\n                    <h3>{{ consultation.teacher.name }}</h3>\r\n                    <p>{{ consultation.subject }} 教师</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"feedback-form-container\">\r\n                <div class=\"feedback-form-header\">\r\n                    <h2>为{{ consultation.teacher.name }}老师的咨询服务评分</h2>\r\n                    <p>请根据此次咨询体验进行评价</p>\r\n                </div>\r\n\r\n                <div v-if=\"submitError\" class=\"error-message\">\r\n                    <i class=\"fas fa-exclamation-circle\"></i>\r\n                    <span>{{ submitError }}</span>\r\n                </div>\r\n\r\n                <form @submit.prevent=\"handleSubmit\" class=\"feedback-form\">\r\n                    <div class=\"rating-section\">\r\n                        <label>服务满意度</label>\r\n                        <div class=\"star-rating\">\r\n                            <button v-for=\"n in 5\" :key=\"n\" type=\"button\"\r\n                                :class=\"['star-btn', n <= feedback.rating ? 'active' : '']\"\r\n                                @click=\"feedback.rating = n\">\r\n                                <i class=\"fas fa-star\"></i>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"form-group\">\r\n                        <label for=\"comment\">评价内容</label>\r\n                        <textarea id=\"comment\" v-model=\"feedback.comment\" rows=\"5\"\r\n                            placeholder=\"请分享您对此次咨询的评价和建议...\"></textarea>\r\n                    </div>\r\n\r\n                    <button type=\"submit\" class=\"submit-btn\" :disabled=\"submitting || !feedback.rating\">\r\n                        <template v-if=\"submitting\">\r\n                            <i class=\"fas fa-spinner fa-spin\"></i> 提交中...\r\n                        </template>\r\n                        <template v-else>\r\n                            <i class=\"fas fa-paper-plane\"></i> 提交评价\r\n                        </template>\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { getConsultationById, submitFeedback } from '../../services/consultationService'\r\n\r\nexport default {\r\n    name: 'ConsultationFeedback',\r\n    setup() {\r\n        const route = useRoute()\r\n        const router = useRouter()\r\n        const { id } = route.params\r\n\r\n        const consultation = ref(null)\r\n        const loading = ref(true)\r\n        const error = ref('')\r\n        const submitting = ref(false)\r\n        const submitError = ref('')\r\n\r\n        const feedback = reactive({\r\n            rating: 0,\r\n            comment: ''\r\n        })\r\n\r\n        // 加载咨询详情\r\n        onMounted(async () => {\r\n            try {\r\n                loading.value = true\r\n                error.value = ''\r\n\r\n                const data = await getConsultationById(id)\r\n\r\n                if (data.status !== 'completed') {\r\n                    error.value = '只能对已完成的咨询进行评价'\r\n                    loading.value = false\r\n                    return\r\n                }\r\n\r\n                consultation.value = data\r\n                loading.value = false\r\n            } catch (err) {\r\n                error.value = err.message || '加载咨询详情失败'\r\n                loading.value = false\r\n                console.error('加载咨询详情错误:', err)\r\n            }\r\n        })\r\n\r\n        // 提交评价\r\n        const handleSubmit = async () => {\r\n            try {\r\n                if (!feedback.rating) {\r\n                    submitError.value = '请选择满意度评分'\r\n                    return\r\n                }\r\n\r\n                submitting.value = true\r\n                submitError.value = ''\r\n\r\n                await submitFeedback(id, feedback)\r\n\r\n                // 提交成功后跳转\r\n                router.push({\r\n                    path: '/student/consultations',\r\n                    query: { feedbackSuccess: 'true' }\r\n                })\r\n            } catch (err) {\r\n                submitError.value = err.message || '提交评价失败，请重试'\r\n                submitting.value = false\r\n                console.error('提交评价错误:', err)\r\n            }\r\n        }\r\n\r\n        return {\r\n            consultation,\r\n            loading,\r\n            error,\r\n            submitting,\r\n            submitError,\r\n            feedback,\r\n            handleSubmit\r\n        }\r\n    }\r\n}\r\n</script>"],"mappings":";;EACSA,KAAK,EAAC;AAA4B;;EAD3CC,GAAA;EAO4BD,KAAK,EAAC;;;EAPlCC,GAAA;EAY+BD,KAAK,EAAC;;;EAZrCC,GAAA;EAoBoBD,KAAK,EAAC;;;EACTA,KAAK,EAAC;AAAiB;mBArBxC;;EAwBqBA,KAAK,EAAC;AAAiB;;EAM3BA,KAAK,EAAC;AAAyB;;EAC3BA,KAAK,EAAC;AAAsB;;EA/BjDC,GAAA;EAoCwCD,KAAK,EAAC;;;EAMrBA,KAAK,EAAC;AAAgB;;EAElBA,KAAK,EAAC;AAAa;oBA5ChD;;EAqDyBA,KAAK,EAAC;AAAY;oBArD3C;;;uBACIE,mBAAA,CAqEM,OArENC,UAqEM,G,4BApEFC,mBAAA,CAGM;IAHDJ,KAAK,EAAC;EAAiB,IACxBI,mBAAA,CAAuB,YAAnB,gBAAc,GAClBA,mBAAA,CAAuB,WAApB,kBAAgB,E,sBAGZC,MAAA,CAAAC,OAAO,I,cAAlBJ,mBAAA,CAGM,OAHNK,UAGM,EAAAC,MAAA,QAAAA,MAAA,OAFFJ,mBAAA,CAAsC;IAAnCJ,KAAK,EAAC;EAAwB,4BACjCI,mBAAA,CAAa,WAAV,QAAM,oB,MAGGC,MAAA,CAAAI,KAAK,I,cAArBP,mBAAA,CAMM,OANNQ,UAMM,G,0BALFN,mBAAA,CAAyC;IAAtCJ,KAAK,EAAC;EAA2B,6BACpCI,mBAAA,CAAwB,cAAAO,gBAAA,CAAfN,MAAA,CAAAI,KAAK,kBACdG,YAAA,CAEcC,sBAAA;IAFDC,EAAE,EAAC,wBAAwB;IAACd,KAAK,EAAC;;IAf3De,OAAA,EAAAC,QAAA,CAeyE,MAE7DR,MAAA,QAAAA,MAAA,OAjBZS,gBAAA,CAeyE,UAE7D,E;IAjBZC,CAAA;yBAoBQhB,mBAAA,CAiDM,OAjDNiB,UAiDM,GAhDFf,mBAAA,CAOM,OAPNgB,UAOM,GANFhB,mBAAA,CAC6B;IADvBiB,GAAG,EAAEhB,MAAA,CAAAiB,YAAY,CAACC,OAAO,CAACC,MAAM;IAAmCC,GAAG,EAAEpB,MAAA,CAAAiB,YAAY,CAACC,OAAO,CAACG,IAAI;IACnG1B,KAAK,EAAC;0BAvB1B2B,UAAA,GAwBgBvB,mBAAA,CAGM,OAHNwB,UAGM,GAFFxB,mBAAA,CAAwC,YAAAO,gBAAA,CAAjCN,MAAA,CAAAiB,YAAY,CAACC,OAAO,CAACG,IAAI,kBAChCtB,mBAAA,CAAoC,WAAAO,gBAAA,CAA9BN,MAAA,CAAAiB,YAAY,CAACO,OAAO,IAAG,KAAG,gB,KAIxCzB,mBAAA,CAsCM,OAtCN0B,UAsCM,GArCF1B,mBAAA,CAGM,OAHN2B,UAGM,GAFF3B,mBAAA,CAAkD,YAA9C,GAAC,GAAAO,gBAAA,CAAGN,MAAA,CAAAiB,YAAY,CAACC,OAAO,CAACG,IAAI,IAAG,WAAS,iB,0BAC7CtB,mBAAA,CAAoB,WAAjB,eAAa,qB,GAGTC,MAAA,CAAA2B,WAAW,I,cAAtB9B,mBAAA,CAGM,OAHN+B,WAGM,G,0BAFF7B,mBAAA,CAAyC;IAAtCJ,KAAK,EAAC;EAA2B,6BACpCI,mBAAA,CAA8B,cAAAO,gBAAA,CAArBN,MAAA,CAAA2B,WAAW,iB,KAtCxCE,mBAAA,gBAyCgB9B,mBAAA,CA0BO;IA1BA+B,QAAM,EAAA3B,MAAA,QAAAA,MAAA,MAzC7B4B,cAAA,KAAAC,IAAA,KAyCuChC,MAAA,CAAAiC,YAAA,IAAAjC,MAAA,CAAAiC,YAAA,IAAAD,IAAA,CAAY;IAAErC,KAAK,EAAC;MACvCI,mBAAA,CASM,OATNmC,WASM,G,0BARFnC,mBAAA,CAAoB,eAAb,OAAK,sBACZA,mBAAA,CAMM,OANNoC,WAMM,I,cALFtC,mBAAA,CAISuC,SAAA,QAjDrCC,WAAA,CA6CgD,CAAC,EAANC,CAAC;WAAhBvC,mBAAA,CAIS;MAJeH,GAAG,EAAE0C,CAAC;MAAEC,IAAI,EAAC,QAAQ;MACxC5C,KAAK,EA9CtC6C,eAAA,cA8CqDF,CAAC,IAAItC,MAAA,CAAAyC,QAAQ,CAACC,MAAM;MACxCC,OAAK,EAAAC,MAAA,IAAE5C,MAAA,CAAAyC,QAAQ,CAACC,MAAM,GAAGJ;uCAC1BvC,mBAAA,CAA2B;MAAxBJ,KAAK,EAAC;IAAa,2B,4BAhDtDkD,WAAA;sCAqDoB9C,mBAAA,CAIM,OAJN+C,WAIM,G,0BAHF/C,mBAAA,CAAiC;IAA1BgD,GAAG,EAAC;EAAS,GAAC,MAAI,sB,gBACzBhD,mBAAA,CACgD;IADtCiD,EAAE,EAAC,SAAS;IAvD9C,uBAAA7C,MAAA,QAAAA,MAAA,MAAAyC,MAAA,IAuDwD5C,MAAA,CAAAyC,QAAQ,CAACQ,OAAO,GAAAL,MAAA;IAAEM,IAAI,EAAC,GAAG;IACtDC,WAAW,EAAC;iDADgBnD,MAAA,CAAAyC,QAAQ,CAACQ,OAAO,E,KAIpDlD,mBAAA,CAOS;IAPDwC,IAAI,EAAC,QAAQ;IAAC5C,KAAK,EAAC,YAAY;IAAEyD,QAAQ,EAAEpD,MAAA,CAAAqD,UAAU,KAAKrD,MAAA,CAAAyC,QAAQ,CAACC;MACxD1C,MAAA,CAAAqD,UAAU,I,cAA1BxD,mBAAA,CAEWuC,SAAA;IA9DnCxC,GAAA;EAAA,I,4BA6D4BG,mBAAA,CAAsC;IAAnCJ,KAAK,EAAC;EAAwB,6B,4BA7D7DiB,gBAAA,CA6DkE,UAC1C,G,8CACAf,mBAAA,CAEWuC,SAAA;IAjEnCxC,GAAA;EAAA,I,4BAgE4BG,mBAAA,CAAkC;IAA/BJ,KAAK,EAAC;EAAoB,6B,4BAhEzDiB,gBAAA,CAgE8D,QACtC,G,8CAjExB0C,WAAA,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}